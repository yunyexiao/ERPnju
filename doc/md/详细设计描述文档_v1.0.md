# 灯具进销存管理系统详细设计描述文档_v1.0
## v1.0 框架
### 南京大学16级软件学院软工二大作业Orz组  
---
变更记录
---
|修改人员|日期|变更原因|版本号|
|:--|:--|:--|:--|
|钱美缘|2017.10.30|文档结构框架|v1.0|

目录
---

## 1 引言
### 1.1 编制目的
本报告详细完成对连锁商店管理系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。  
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。  

### 1.2 词汇表
|词汇名称|词汇含义|备注|
|---|---|---|
|ERP|进销存管理系统|无|

### 1.3 参考资料
* 灯具进销存系统用例文档_v2.0
* 灯具进销存系统需求规格说明文档_v2.1
* 灯具进销存系统体系结构设计文档_v2.1  

## 2 产品概述
参考灯具进销存系统用例文档和灯具进销存需求规格说明文档中对产品的概括描述。  

## 3 体系结构设计概述 
参考灯具进销存系统体系结构设计文档中对体系结构设计的描述。  

## 4 结构视角
### 4.1 业务逻辑层的分解
业务逻辑层的开发包图参见软件体系结构设计文档图4-1-1。  

<!--以下为格式示例，给各位复制粘贴用
#### 4.1.0 xxxBL模块
#### 4.1.0.1 模块概述
BL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
BL模块的职责及接口参见体系结构设计文档。  

#### 4.1.0.2 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加___接口。业务逻辑层和数据层之间添加___接口。为了隔离业务逻辑职责和逻辑控制职责，我们增加了__Controller，这样__Controller会对__的业务逻辑处理委托给__对象。__PO是作为____的持久化对象添加到设计模型中去的。…………(后面的自己补充)   
<此处省略一张图>
<此处省略一张表>

#### 4.1.0.3 模块内部类的接口规范

#### 4.1.0.4 业务逻辑层的动态模型

-->
#### 4.1.0 initBL模块
#### 4.1.0.1 模块概述
initBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
initBL模块的职责及接口参见体系结构设计文档。  

#### 4.1.0.2 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加initBLService接口。业务逻辑层和数据层之间添加initDataService接口。initPO是作为期初数据的持久化对象添加到设计模型中去的。在期初建账的时候，InitBL需要知道上一期末的商品信息、客户信息、账户信息等，因此需要CommodityInfo、AccountInfo、CustomerInfo、CategoryInfo接口获取这些信息。  
InitBL模块的设计如图4-1-0-1所示  
![](doc\img\DesignDiagrams\InitBLClass.png)  
<centre>图4-1-0-1  InitBL模块各个类的设计</centre>
InitBL模块的各个类的职责如表4-1-0-1所示  
<centre>表4-1-0-1  InitBL模块各个类的职责</centre>
|模块|职责|
|---|---|
|InitBL|负责实现期初建账界面所需要的服务|

#### 4.1.0.3 模块内部类的接口规范
InitBL的接口规范如表4-1-0-3所示  
<table>
<caption>表4-1-0-3 InitBL模块的接口规范 </caption>  
    <tr>
        <td colspan="3"><div class="text" style=" text-align:center;">提供的服务（供接口）</div></td>
    </tr>
    <tr>
        <td rowspan="3">Init.create</td>
        <td>语法</td>
        <td>public boolean create()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动期初建账定任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存期初建账结果，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Init.check</td>
        <td>语法</td>
        <td>public InitVO check(string year)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>期初建账已完成</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回查询结果</td>
    </tr>
</table>

<table>
    <tr>
        <td colspan="2"><div class="text" style=" text-align:center;">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>InitDataService.get(string year)</td>
        <td>得到对应年度的持久化InitPO记录</td>
    </tr>
    <tr>
        <td>InitDataService.add(InitPO ipo)</td>
        <td>添加单一持久化InitPO记录</td>
    </tr>
    <tr>
        <td>CategoryInfo.get()</td>
        <td>根据关键字获取多个持久化CategoryPO记录</td>
    </tr>
    <tr>
        <td>CommodityInfo.get()</td>
        <td>根据关键字获取多个持久化CustomerPO记录</td>
    </tr>
    <tr>
        <td>CustomerInfo.get()</td>
        <td>根据关键字获取多个持久化CustomerPO记录</td>
    </tr>
    <tr>
        <td>AccountInfo.get()</td>
        <td>根据关键字获取多个持久化AccountPO记录</td>
    </tr>
</table>

#### 4.1.0.4 业务逻辑层的动态模型
图4-1-0-2表明了进销存管理系统中，查看期初信息的业务逻辑处理的相关对象之间的协作。  
![](doc\img\DesignDiagrams\InitBLModel1.png)  
<centre>图4-1-0-2  查看往期期初信息的顺序图</centre>
图4-1-0-3表明了进销存管理系统中，期初建账的业务逻辑处理的相关对象之间的协作。  
![](doc\img\DesignDiagrams\InitBLModel2.png)  
<centre>图4-1-0-3  期初建账的顺序图</centre>
如图4-1-0-4所示的状态图描述了InitBL对象在执行查看期初信息任务时的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果check方法被UI调用，进入Input状态，如果用户输入正确格式的年份，进入showInitInfo状态，之后等待用户操作进入结束状态   
![](doc\img\DesignDiagrams\InitBLModel3.png)  
<centre>图4-1-0-4  InitBL对象执行查看期初信息状态图</centre>
如图4-1-0-5所示的状态图描述了InitBL对象在执行期初建账任务的生存期间的状态序列，引起转移的事件和因状态转移而伴随的动作。如果add方法被UI调用，进入check状态，系统依次调用CommodityInfo、AccountInfo、CustomerInfo、CategoryInfo接口中的get方法获取信息，如果信息不全则进入建账失败的fail状态，否则进入save状态，之后退出期初建账过程进入结束状态。  
![](doc\img\DesignDiagrams\InitBLModel4.png)  
<centre>图4-1-0-5  InitBL对象执行期初建账状态图</centre>

## 5 依赖视角
