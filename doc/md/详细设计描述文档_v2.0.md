# 灯具进销存管理系统详细设计描述文档_v2.2
## v2.2 正式版
### 南京大学16级软件学院软工二大作业Orz组  
---
变更记录
---
|修改人员|日期|变更原因|版本号|
|:--|:--|:--|:--|
|钱美缘|2017.10.30|文档结构框架|v1.0|
|全体成员|2017.11.08|第一稿|v2.0|
|全体成员|2018.01.01|整体性细节修改|v2.1|
|郝睿|2018.01.12|针对文档一致性进行的整体性细节修改|v2.2|

目录
---

* [1 引言](#1-引言)
	* [1.1 编制目的](#11-编制目的)
	* [1.2 词汇表](#12-词汇表)
	* [1.3 参考资料](#13-参考资料)
* [2 产品概述](#2-产品概述)
* [3 体系结构设计概述](#3-体系结构设计概述)
* [4 结构视角](#4-结构视角)
	* [4.1 业务逻辑层的分解](#41-业务逻辑层的分解)
		* [4.1.0 xxxBL模块](#410-xxxbl模块)
		* [4.1.0.1 模块概述](#4101-模块概述)
		* [4.1.0.2 整体结构](#4102-整体结构)
		* [4.1.0.3 模块内部类的接口规范](#4103-模块内部类的接口规范)
		* [4.1.0.4 业务逻辑层的动态模型](#4104-业务逻辑层的动态模型)
		* [4.1.1 CategoryBL模块](#411-categorybl模块)
		* [4.1.1.1 模块概述](#4111-模块概述)
		* [4.1.1.2 整体结构](#4112-整体结构)
		* [4.1.1.3 模块内部类的接口规范](#4113-模块内部类的接口规范)
		* [4.1.1.4 业务逻辑层的动态模型](#4114-业务逻辑层的动态模型)
		* [4.1.2 CommodityBL模块](#412-commoditybl模块)
		* [4.1.2.1 模块概述](#4121-模块概述)
		* [4.1.2.2 整体结构](#4122-整体结构)
		* [4.1.2.3 模块内部类的接口规范](#4123-模块内部类的接口规范)
		* [4.1.2.4 业务逻辑层的动态模型](#4124-业务逻辑层的动态模型)
		* [4.1.3 AccountBL模块](#413-accountbl模块)
		* [4.1.3.1 模块概述](#4131-模块概述)
		* [4.1.3.2 整体结构](#4132-整体结构)
		* [4.1.3.3 模块内部类的接口规范](#4133-模块内部类的接口规范)
		* [4.1.3.4 业务逻辑层的动态模型](#4134-业务逻辑层的动态模型)
		* [4.1.4 CustomerBL模块](#414-customerbl模块)
		* [4.1.4.1 模块概述](#4141-模块概述)
		* [4.1.4.2 整体结构](#4142-整体结构)
		* [4.1.4.3 模块内部类的接口规范](#4143-模块内部类的接口规范)
		* [4.1.4.4 业务逻辑层的动态模型](#4144-业务逻辑层的动态模型)
		* [4.1.5 UserBL模块](#415-userbl模块)
		* [4.1.5.1 模块概述](#4151-模块概述)
		* [4.1.5.2 整体结构](#4152-整体结构)
		* [4.1.5.3 模块内部类的接口规范](#4153-模块内部类的接口规范)
		* [4.1.5.4 业务逻辑层的动态模型](#4154-业务逻辑层的动态模型)
		* [4.1.6 billbl模块](#416-billbl模块)
		* [4.1.6.1 模块概述](#4161-模块概述)
		* [4.1.6.2 整体结构](#4162-整体结构)
		* [4.1.6.3 模块内部类的接口规范](#4163-模块内部类的接口规范)
		* [4.1.6.4 业务逻辑层动态模型](#4164-业务逻辑层动态模型)
		* [4.1.7 initBL模块](#417-initbl模块)
		* [4.1.7.1 模块概述](#4171-模块概述)
		* [4.1.7.2 整体结构](#4172-整体结构)
		* [4.1.7.3 模块内部类的接口规范](#4173-模块内部类的接口规范)
		* [4.1.7.4 业务逻辑层的动态模型](#4174-业务逻辑层的动态模型)
		* [4.1.8 LogBL模块](#418-logbl模块)
		* [4.1.8.1 模块概述](#4181-模块概述)
		* [4.1.8.2 整体结构](#4182-整体结构)
		* [4.1.8.3 模块内部类的接口规范](#4183-模块内部类的接口规范)
		* [4.1.8.4 业务逻辑层的动态模型](#4184-业务逻辑层的动态模型)
	* [4.2 界面层的分解](#42-界面层的分解)
		* [4.2.1 登录模块与主窗体模块](#421-登录模块与主窗体模块)
		* [4.2.2 基础数据模块](#422-基础数据模块)
		* [4.2.3 单据制定模块](#423-单据制定模块)
		* [4.2.4 统计分析模块](#424-统计分析模块)
		* [4.2.5 通用组件模块](#425-通用组件模块)
* [5 依赖视角](#5-依赖视角)


## 1 引言
### 1.1 编制目的
本报告详细完成对连锁商店管理系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。  
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。  

### 1.2 词汇表
|词汇名称|词汇含义|备注|
|---|---|---|
|ERP|进销存管理系统|无|

### 1.3 参考资料
* 灯具进销存系统用例文档_v2.3
* 灯具进销存系统需求规格说明文档_v2.3
* 灯具进销存系统体系结构设计文档_v2.3  

## 2 产品概述
参考灯具进销存系统用例文档和灯具进销存需求规格说明文档中对产品的概括描述。  

## 3 体系结构设计概述 
参考灯具进销存系统体系结构设计文档中对体系结构设计的描述。  

## 4 结构视角

### 4.1 业务逻辑层的分解
业务逻辑层的开发包图参见软件体系结构设计文档图4-1-1。  

#### 4.1.1 CategoryBL模块

#### 4.1.1.1 模块概述  
 
CategoryBL模块承担的需求参见需求规格说明文档功能需求及相关非公功能需求。  
CategoryBL模块的职责和接口详见体系结构设计文档。  

#### 4.1.1.2 整体结构  
  
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层与业务逻辑层之间，我们添加了BLService.CategoryBLService接口。业务逻辑层和数据层之间我们添加了DataService.CategoryDataService接口。PO.CategoryPO是作为商品分类的持久化对象而添加到设计模型中去的。  
CategoryBL模块的设计如图4-1-1-1所示。  
<center>![Alt text](./CategoryModule.png)</center>
  
<center>图4-1-1-1 CategoryBL模块各个类的设计</center>

CategoryBL模块各个类的职责如表4-1-1-1所示。  
<center>表4-1-1-1  CategoryBL模块各个类的职责</center>

|模块|职责|
|:---|:---|
|CategoryBL|负责提供商品分类管理界面所需要的服务|

#### 4.1.1.3 模块内部类的接口规范

CategoryBL的接口规范如表4-1-1-2所示。  
表4-1-1-2  
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3"> Category.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动添加商品分类任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该商品分类对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3"> Category.add</td>
        <td>语法</td>
        <td>public boolean add( CategoryVO  category)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动商品分类管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新商品分类，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3"> Category.change</td>
        <td>语法</td>
        <td>public boolean change CategoryVO category)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>商品分类存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3"> Category.delete</td>
        <td>语法</td>
        <td>public boolean delete(string id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>商品分类存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除商品分类，返回删除信息，持久化更新所涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3"> Category.hasContent</td>
        <td>语法</td>
        <td>public boolean hasContent(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>商品分类存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该节点下是否有子节点信息</td>
    </tr>
	<tr>
        <td rowspan="3"> Category.getModel</td>
        <td>语法</td>
        <td>public DefaultTreeModel getModel()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动商品分类管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回商品分类的树形展示</td>
    </tr>
	<tr>
        <td rowspan="3"> Category.findById</td>
        <td>语法</td>
        <td>public CategoryVO findById(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动商品分类的查询任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查询商品分类的查询结果</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>CategoryDataService.getnewId()</td>
        <td>得到自动生成的该商品分类对应的唯一id</td>
    </tr>
    <tr>
        <td>CategoryDataService.findById(string id)</td>
        <td>根据id查找单一持久化CategoryPO记录</td>
    </tr>
    <tr>
        <td>CategoryDataService.getCategorysBy(String field, String content, boolean isfuzzy)</td>
        <td>根据条件查找多个持久化CategoryPO记录</td>
    </tr>
     <tr>
        <td>CategoryDataService.add(CategoryPO cpo)</td>
        <td>插入单一持久化CategoryPO记录</td>
    </tr>
     <tr>
        <td>CategoryDataService.delete(String id)</td>
        <td>删除单一持久化CategoryPO记录</td>
    </tr>
    <tr>
        <td>CategoryDataService.update(CategoryPO cpo)</td>
        <td>更新单一持久化CategoryPO记录</td>
    </tr>
    <tr>
        <td>CategoryDataService.getAllCategory()</td>
        <td>返回数据库中所有商品分类的PO对象</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>


#### 4.1.1.4 业务逻辑层的动态模型

图4-1-1-2表明了在进销存系统中，在增加一个商品分类的过程中输入一个商品分类信息之后，商品分类管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CategoryAddSd.png)</center>
  
<center>图4-1-1-2  增加新商品分类的顺序图</center>

图4-1-1-3表明了在进销存系统中，在删除一个商品分类的过程中输入一个商品分类ID之后，商品分类管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CategoryDelSd.png)</center>
  
<center>图4-1-1-3  删除商品分类的顺序图</center>

图4-1-1-4表明了在进销存系统中，在修改一个商品分类的过程中输入一个商品分类信息之后，商品分类管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CategoryUpdateSd.png)</center>
<center>图4-1-1-4  修改商品分类信息的顺序图</center>

图4-1-1-5表明了在进销存系统中，在查询一个商品分类的过程中输入一个商品分类信息之后，商品分类管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CategoryFindSd.png)</center>
  
<center>图4-1-1-5  查询商品分类信息的顺序图</center>

如图4-1-1-6所示的状态图描述了CategoryBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果add方法被UI调用，CategoryBL进入waitForInput状态，之后通过vaild进入newCategory状态，最后通过confirm进入结束状态。在waitForInput状态也可以通过cancel直接进入结束状态。  
<center>![Alt text](./CategoryAddStm.png)</center>
  
<center>图4-1-1-6  增加新商品分类的状态图</center>

如图4-1-1-7所示的状态图描述了CategoryBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被ui调用，CategoryBL进入showInfo状态，最后通过confirm进入结束状态。在showInfo状态下也可以通过return直接进入结束状态。  
<center>![Alt text](./CategoryDelStm.png)</center>
  
<center>图4-1-1-7  查找某一商品分类的状态图</center>

如图4-1-1-8所示的状态图描述了CategoryBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被ui调用，CategoryBL进入waitForInput状态，之后通过valid进入CategoryInfo状态，最后通过confirm进入结束状态。在waitForInput状态下也可以通过cancel直接进入结束状态。  
<center>![Alt text](./CategoryUpdateStm.png)</center>

<center>图4-1-1-8  修改商品分类信息的状态图</center>

如图4-1-1-9所示的状态图描述了CategoryBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findById/findByName方法被ui调用，CategoryBL进入waitForInput状态，之后通过valid进入CategoryInfo状态，最后通过exit进入结束状态。在waitForInput状态下，也可以通过cancel进入结束状态。在CategoryInfo状态下可以通过再次调用findById/findByName方法进入waitForInput状态。  
<center>![Alt text](./CategoryFindStm.png)</center>
  
<center>图4-1-1-9  根据ID或者名称查找的状态图</center>

#### 4.1.2 CommodityBL模块

#### 4.1.2.1 模块概述  
  
CommodityBL模块承担的需求参见需求规格说明文档功能需求及相关非公功能需求。  
CommodityBL模块的职责和接口详见体系结构设计文档中表13。  

#### 4.1.2.2 整体结构  
  
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层与业务逻辑层之间，我们添加了BLService.CommodityBLService接口。业务逻辑层和数据层之间我们添加了DataService.CommodityDataService接口。PO.CommodityPO是作为商品的持久化对象而添加到设计模型中去的。  
CommodityBL模块的设计如图4-1-2-1所示。  
<center>![Alt text](./CommodityModule.png)</center>
  
图4-1-2-1 CommodityBL模块各个类的设计  

CommodityBL模块各个类的职责如表4-1-2-1所示。  
表4-1-2-1  

|模块|职责|
|:---|:---|
|CommodityBL|负责商品管理界面所需要的服务|

#### 4.1.2.3 模块内部类的接口规范

CommodityBL的接口规范如表4-1-2-2所示。  
表4-1-2-2  
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Commodity.search(String type, String key)</td>
        <td>语法</td>
        <td>public MyTableModel search(String type, String key) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动商品管理的查询任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回查询商品信息的结果</td>
    </tr>
    <tr>
        <td rowspan="3">Commodity.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动添加商品任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该商品对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3">Commodity.add</td>
        <td>语法</td>
        <td>public boolean add(CommodityVO com_info)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动商品管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新商品，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Commodity.change</td>
        <td>语法</td>
        <td>public boolean change(CommodityVO com_info)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>商品存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Commodity.delete</td>
        <td>语法</td>
        <td>public boolean delete(string id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>商品存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除商品，返回删除信息，持久化更新所涉及的数据</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>CommodityDataService.getnewId()</td>
        <td>得到自动生成的该商品对应的唯一id</td>
    </tr>
    <tr>
        <td>CommodityDataService.findById(string id)</td>
        <td>根据id查找单一持久化CommodityPO记录</td>
    </tr>
    <tr>
        <td>CommodityDataService.getCommoditysBy(String field, String content, boolean isfuzzy)</td>
        <td>根据条件查找多个持久化CommodityPO记录</td>
    </tr>
     <tr>
        <td>CommodityDataService.add(CommodityPO cpo)</td>
        <td>插入单一持久化CommodityPO记录</td>
    </tr>
     <tr>
        <td>CommodityDataService.delete(String id)</td>
        <td>删除单一持久化CommodityPO记录</td>
    </tr>
    <tr>
        <td>CommodityDataService.update(CommodityPO cpo)</td>
        <td>更新单一持久化CommodityPO记录</td>
    </tr>
    <tr>
        <td>CommodityDataService.getAllCommodity()</td>
        <td>返回数据库中所有商品的PO对象</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>

#### 4.1.2.4 业务逻辑层的动态模型

图4-1-2-2表明了在进销存系统中，在增加一个商品的过程中输入一个商品信息之后，商品管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CommodityAddSd.png)</center>
  
<center>图4-1-2-2  </center>

图4-1-2-3表明了在进销存系统中，在删除一个商品的过程中输入一个商品ID之后，商品管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CommodityDelSd.png)</center>
  
<center>图4-1-2-3  </center>

图4-1-2-4表明了在进销存系统中，在修改一个商品的过程中输入一个商品信息之后，商品管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CommodityUpdateSd.png)</center>
  
<center>图4-1-2-4  </center>

图4-1-2-5表明了在进销存系统中，在查询一个商品的过程中输入一个商品信息之后，商品管理业务逻辑处理的相关的对象之间的协作。  
<center>![Alt text](./CommodityFindSd.png)</center>
  
<center>图4-1-2-5  </center>

如图4-1-2-6所示的状态图描述了CommodityBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果add方法被UI调用，CommodityBL进入waitForInput状态，之后通过vaild进入newCommodity状态，最后通过confirm进入结束状态。在waitForInput状态也可以通过cancel直接进入结束状态。  
<center>![Alt text](./CommodityAddStm.png)</center>
  
<center>图4-1-2-6  </center>

如图4-1-2-7所示的状态图描述了CommodityBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被ui调用，CommodityBL进入showInfo状态，最后通过confirm进入结束状态。在showInfo状态下也可以通过return直接进入结束状态。  
<center>![Alt text](./CommodityDelStm.png)</center>
  
<center>图4-1-2-7  </center>

如图4-1-2-8所示的状态图描述了CommodityBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被ui调用，CommodityBL进入waitForInput状态，之后通过valid进入CommodityInfo状态，最后通过confirm进入结束状态。在waitForInput状态下也可以通过cancel直接进入结束状态。  
<center>![Alt text](./CommodityUpdateStm.png)</center>

<center>图4-1-2-8  </center>

如图4-1-2-9所示的状态图描述了CommodityBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findById/findByName方法被ui调用，CommodityBL进入waitForInput状态，之后通过valid进入CommodityInfo状态，最后通过exit进入结束状态。在waitForInput状态下，也可以通过cancel进入结束状态。在CommodityInfo状态下可以通过再次调用findById/findByName方法进入waitForInput状态。  
<center>![Alt text](./CommodityFindStm.png)</center>
  
<center>图4-1-2-9  </center>


#### 4.1.3 AccountBL模块

#### 4.1.3.1 模块概述  
 
AccountBL模块承担的需求参见需求规格说明文档功能需求及相关非公功能需求。  
AccountBL模块的职责和接口详见体系结构设计文档。  

#### 4.1.3.2 整体结构  
  
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层与业务逻辑层之间，我们添加了BLService.AccountBLService接口。业务逻辑层和数据层之间我们添加了DataService.AccountDataService接口。PO.AccountPO是作为账户的持久化对象而添加到设计模型中去的。  
AccountBL模块的设计如图4-1-3-1所示。  
![Alt text](./AccountModule.png)
  
图4-1-3-1 AccountBL模块各个类的设计  

AccountBL模块各个类的职责如表4-1-3-1所示。  
表4-1-3-1  

|模块|职责|
|:---|:---|
|AccountBL|负责账户管理界面所需要的服务|

#### 4.1.3.3 模块内部类的接口规范

AccountBL的接口规范如表4-1-3-2所示。  
表4-1-3-2  AccountBL的接口规范  
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Account.getAccount(String id)</td>
        <td>语法</td>
        <td>public AccountVO getAccount(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>登录成功并启动根据id查找银行账户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该id对应的唯一银行账户的VO对象</td>
    </tr>
    <tr>
        <td rowspan="3">Account.search(String type, String key)</td>
        <td>语法</td>
        <td>public MyTableModel search(String type, String key)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>登录成功并启动银行账户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据条件查询的多个银行账户信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3">Account.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动添加账户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该账户对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3">Account.add</td>
        <td>语法</td>
        <td>public boolean add(AccountVO acc_info)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>登录成功并启动银行账户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新的银行账户，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Account.change</td>
        <td>语法</td>
        <td>public boolean change(AccountVO acc_info)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>此银行账户已创建</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Account.delete</td>
        <td>语法</td>
        <td>public boolean delete(string id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>次银行账户已添加到系统中</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除此银行账户，持久化更新所涉及的数据</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>AccountDataService.getnewId()</td>
        <td>得到自动生成的该账户对应的唯一id</td>
    </tr>
    <tr>
        <td>AccountDataService.findById(string id)</td>
        <td>根据id查找单一持久化AccountPO记录</td>
    </tr>
    <tr>
        <td>AccountDataService.getAccountsBy(String field, String content, boolean isfuzzy)</td>
        <td>根据条件查找多个持久化AccountPO记录</td>
    </tr>
     <tr>
        <td>AccountDataService.add(AccountPO account)</td>
        <td>插入单一持久化AccountPO记录</td>
    </tr>
     <tr>
        <td>AccountDataService.delete(String id)</td>
        <td>删除单一持久化AccountPO记录</td>
    </tr>
    <tr>
        <td>AccountDataService.update(AccountPO account)</td>
        <td>更新单一持久化AccountPO记录</td>
    </tr>
    <tr>
        <td>AccountDataService.getAllAccount()</td>
        <td>返回数据库中所有账户的PO对象</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>
#### 4.1.3.4 业务逻辑层的动态模型

图4-1-3-2表明了在进销存系统中，在增加一个账户的过程中输入一个账户信息之后，账户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./AccountAddSd.png)
  
图4-1-3-2  

图4-1-3-3表明了在进销存系统中，在删除一个账户的过程中输入一个账户ID之后，账户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./AccountDelSd.png)
  
图4-1-3-3  

图4-1-3-4表明了在进销存系统中，在修改一个账户的过程中输入一个账户信息之后，账户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./AccountUpdateSd.png)
  
图4-1-3-4  

图4-1-3-5表明了在进销存系统中，在查询一个账户的过程中输入一个账户信息之后，账户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./AccountFindSd.png)
  
图4-1-3-5  

如图4-1-3-6所示的状态图描述了AccountBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果add方法被UI调用，AccountBL进入waitForInput状态，之后通过vaild进入newAccount状态，最后通过confirm进入结束状态。在waitForInput状态也可以通过cancel直接进入结束状态。  
![Alt text](./AccountAddStm.png)
  
图4-1-3-6  

如图4-1-3-7所示的状态图描述了AccountBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被ui调用，AccountBL进入showInfo状态，最后通过confirm进入结束状态。在showInfo状态下也可以通过return直接进入结束状态。  
![Alt text](./AccountDelStm.png)
  
图4-1-3-7  

如图4-1-3-8所示的状态图描述了AccountBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被ui调用，AccountBL进入waitForInput状态，之后通过valid进入AccountInfo状态，最后通过confirm进入结束状态。在waitForInput状态下也可以通过cancel直接进入结束状态。  
![Alt text](./AccountUpdateStm.png)

图4-1-3-8  

如图4-1-3-9所示的状态图描述了AccountBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findById/findByName方法被ui调用，AccountBL进入waitForInput状态，之后通过valid进入AccountInfo状态，最后通过exit进入结束状态。在waitForInput状态下，也可以通过cancel进入结束状态。在AccountInfo状态下可以通过再次调用findById/findByName方法进入waitForInput状态。  
![Alt text](./AccountFindStm.png)
  
图4-1-3-9  


#### 4.1.4 CustomerBL模块

#### 4.1.4.1 模块概述  
 
CustomerBL模块承担的需求参见需求规格说明文档功能需求及相关非公功能需求。  
CustomerBL模块的职责和接口详见体系结构设计文档。  

#### 4.1.4.2 整体结构  
  
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层与业务逻辑层之间，我们添加了BLService.CustomerBLService接口。业务逻辑层和数据层之间我们添加了DataService.CustomerDataService接口。PO.CustomerPO是作为顾客的持久化对象而添加到设计模型中去的。  
CustomerBL模块的设计如图4-1-4-1所示。  
![Alt text](./CustomerModule.png)
  
图4-1-4-1 CustomerBL模块各个类的设计  

CustomerBL模块各个类的职责如表4-1-4-1所示。  
表4-1-4-1  

|模块|职责|
|:---|:---|
|CustomerBL|负责顾客管理界面所需要的服务|

#### 4.1.4.3 模块内部类的接口规范

CustomerBL的接口规范如表4-1-4-2所示。  
表4-1-4-2  
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Customer.getCustomer</td>
        <td>语法</td>
        <td>public CustomerVO getCustomer(string id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查询客户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回查询的客户信息的结果</td>
    </tr>
     <tr>
        <td rowspan="3">Customer.search</td>
        <td>语法</td>
        <td>public MyTableModel search(String type, String key)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动客户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的客户信息的结果列表</td>
    </tr>
    <tr>
        <td rowspan="3">Customer.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动增加客户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该客户对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3">Customer.add</td>
        <td>语法</td>
        <td>public boolean add(CustomerVO customer)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动客户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新的客户，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Customer.change</td>
        <td>语法</td>
        <td>public boolean change(CustomerVO customer)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>客户已添加到系统中</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Customer.delete</td>
        <td>语法</td>
        <td>public boolean delete（String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>客户已添加到系统中</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除特定客户，持久化更新所涉及的数据</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2"><strong><div class="text" style=" text-align:center;">需要的接口（需接口）</div></strong></td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>CustomerDataService.getNewId()</td>
        <td>得到自动生成的该客户对应的唯一id</td>
    </tr>
    <tr>
        <td>CustomerDataService.findById(string id)</td>
        <td>根据id查找单一持久化CustomerPO记录</td>
    </tr>
    <tr>
        <td>CustomerDataService.getCustomersBy(String field, String content, boolean isfuzzy)</td>
        <td>根据条件查找多个持久化CustomerPO记录</td>
    </tr>
     <tr>
        <td>CustomerDataService.add(CustomerPO customer)</td>
        <td>插入单一持久化CustomerPO记录</td>
    </tr>
     <tr>
        <td>CustomerDataService.delete(String id)</td>
        <td>删除单一持久化CustomerPO记录</td>
    </tr>
    <tr>
        <td>CustomerDataService.update(CustomerPO customer)</td>
        <td>更新单一持久化CustomerPO记录</td>
    </tr>
    <tr>
        <td>CustomerDataService.getAllCustomer()</td>
        <td>返回数据库中所有客户的PO对象</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>
#### 4.1.4.4 业务逻辑层的动态模型

图4-1-4-2表明了在进销存系统中，在增加一个顾客的过程中输入一个顾客信息之后，顾客管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./CustomerAddSd.png)
  
图4-1-4-2  

图4-1-4-3表明了在进销存系统中，在删除一个顾客的过程中输入一个顾客ID之后，顾客管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./CustomerDelSd.png)
  
图4-1-4-3  

图4-1-4-4表明了在进销存系统中，在修改一个顾客的过程中输入一个顾客信息之后，顾客管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./CustomerUpdateSd.png)
![](doc/img/DesignDiagrams/CustomerUpdateSd.png)  
图4-1-4-4  

图4-1-4-5表明了在进销存系统中，在查询一个顾客的过程中输入一个顾客信息之后，顾客管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./CustomerFindSd.png)
  
图4-1-4-5  

如图4-1-4-6所示的状态图描述了CustomerBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果add方法被UI调用，CustomerBL进入waitForInput状态，之后通过vaild进入newCustomer状态，最后通过confirm进入结束状态。在waitForInput状态也可以通过cancel直接进入结束状态。  
![Alt text](./CustomerAddStm.png)
  
图4-1-4-6  

如图4-1-4-7所示的状态图描述了CustomerBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被ui调用，CustomerBL进入showInfo状态，最后通过confirm进入结束状态。在showInfo状态下也可以通过return直接进入结束状态。  
![Alt text](./CustomerDelStm.png)

图4-1-4-7  

如图4-1-4-8所示的状态图描述了CustomerBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被ui调用，CustomerBL进入waitForInput状态，之后通过valid进入CustomerInfo状态，最后通过confirm进入结束状态。在waitForInput状态下也可以通过cancel直接进入结束状态。  
![Alt text](./CustomerUpdateStm.png)
  
图4-1-4-8  

如图4-1-4-9所示的状态图描述了CustomerBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findById/findByName方法被ui调用，CustomerBL进入waitForInput状态，之后通过valid进入CustomerInfo状态，最后通过exit进入结束状态。在waitForInput状态下，也可以通过cancel进入结束状态。在CustomerInfo状态下可以通过再次调用findById/findByName方法进入waitForInput状态。  
![Alt text](./CustomerFindStm.png)
  
图4-1-4-9  


#### 4.1.5 UserBL模块

#### 4.1.5.1 模块概述  
 
UserBL模块承担的需求参见需求规格说明文档功能需求及相关非公功能需求。  
UserBL模块的职责和接口详见体系结构设计文档。  

#### 4.1.5.2 整体结构  
  
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层与业务逻辑层之间，我们添加了BLService.UserBLService接口。业务逻辑层和数据层之间我们添加了DataService.UserDataService接口。PO.UserPO是作为用户的持久化对象而添加到设计模型中去的。  
UserBL模块的设计如图4-1-5-1所示。  
![Alt text](./UserModule.png)
  
图4-1-5-1 UserBL模块各个类的设计  

UserBL模块各个类的职责如表4-1-5-1所示。  
表4-1-5-1  

|模块|职责|
|:---|:---|
|UserBL|负责用户管理界面所需要的服务|

#### 4.1.5.3 模块内部类的接口规范

UserBL的接口规范如表4-1-5-2所示。  
表4-1-5-2  
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">User.getUser</td>
        <td>语法</td>
        <td>public UserVO getUser(string id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查询用户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回查询的用户信息的结果</td>
    </tr>
     <tr>
        <td rowspan="3">User.search</td>
        <td>语法</td>
        <td>public MyTableModel search(String type, String key)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动用户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的用户信息的结果列表</td>
    </tr>
<tr>
        <td rowspan="3">User.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动增加用户任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该用户对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3">User.add</td>
        <td>语法</td>
        <td>public boolean add(UserVO user)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动用户管理任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新的用户，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">User.change</td>
        <td>语法</td>
        <td>public boolean change(UserVO user)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>用户已添加到系统中</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">User.delete</td>
        <td>语法</td>
        <td>public boolean delete（String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>用户已添加到系统中</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除特定用户，持久化更新所涉及的数据</td>
    </tr>
</table>

<table>
    <tr>
        <td colspan="2"><strong><div class="text" style=" text-align:center;">需要的接口（需接口）</div></strong></td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>UserDataService.getNewId()</td>
        <td>得到自动生成的该用户对应的唯一id</td>
    </tr>
    <tr>
        <td>UserDataService.findById(string id)</td>
        <td>根据id查找单一持久化UserPO记录</td>
    </tr>
    <tr>
        <td>UserDataService.getUsersBy(String field, String content, boolean isfuzzy)</td>
        <td>根据条件查找多个持久化UserPO记录</td>
    </tr>
     <tr>
        <td>UserDataService.add(UserPO user)</td>
        <td>插入单一持久化UserPO记录</td>
    </tr>
     <tr>
        <td>UserDataService.delete(String id)</td>
        <td>删除单一持久化UserPO记录</td>
    </tr>
    <tr>
        <td>UserDataService.update(UserPO User)</td>
        <td>更新单一持久化UserPO记录</td>
    </tr>
    <tr>
        <td>UserDataService.getAllUser()</td>
        <td>返回数据库中所有用户的PO对象</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>

#### 4.1.5.4 业务逻辑层的动态模型

图4-1-5-2表明了在进销存系统中，在增加一个用户的过程中输入一个用户信息之后，用户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./UserAddSd.png)
  
图4-1-5-2  

图4-1-5-3表明了在进销存系统中，在删除一个用户的过程中输入一个用户ID之后，用户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./UserDelSd.png)

图4-1-5-3  

图4-1-5-4表明了在进销存系统中，在修改一个用户的过程中输入一个用户信息之后，用户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./UserUpdateSd.png)

图4-1-5-4  

图4-1-5-5表明了在进销存系统中，在查询一个用户的过程中输入一个用户信息之后，用户管理业务逻辑处理的相关的对象之间的协作。  
![Alt text](./UserFindSd.png)
  
图4-1-5-5  

如图4-1-5-6所示的状态图描述了UserBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果add方法被UI调用，UserBL进入waitForInput状态，之后通过vaild进入newUser状态，最后通过confirm进入结束状态。在waitForInput状态也可以通过cancel直接进入结束状态。  
![Alt text](./UserAddStm.png)

图4-1-5-6  

如图4-1-5-7所示的状态图描述了UserBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被ui调用，UserBL进入showInfo状态，最后通过confirm进入结束状态。在showInfo状态下也可以通过return直接进入结束状态。  
![Alt text](./UserDelStm.png)

图4-1-5-7  

如图4-1-5-8所示的状态图描述了UserBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被ui调用，UserBL进入waitForInput状态，之后通过valid进入UserInfo状态，最后通过confirm进入结束状态。在waitForInput状态下也可以通过cancel直接进入结束状态。  
![Alt text](./UserUpdateStm.png)
  
图4-1-5-8  

如图4-1-5-9所示的状态图描述了UserBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findById/findByName方法被ui调用，UserBL进入waitForInput状态，之后通过valid进入UserInfo状态，最后通过exit进入结束状态。在waitForInput状态下，也可以通过cancel进入结束状态。在UserInfo状态下可以通过再次调用findById/findByName方法进入waitForInput状态。  
![Alt text](./UserFindStm.png)
  
图4-1-5-9  

#### 4.1.6 billbl模块  
#### 4.1.6.1 模块概述  
billbl 模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
billbl 模块的职责及接口参见软件系统结构设计文档。  

#### 4.1.6.2 整体结构  
根据体系结构的设计，快递物流系统选择分层体系结构风格，将系统分为 3 层（展示层、业务逻辑层、数据层）,很好地示意了整个高层抽象。展示层包含GUI 页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。每一层之间为了增加灵活性，添加了接口，比如在展示层和业务逻辑层之间添加blservice.billblservice.BillBLService接口，在业务逻辑层和数据层之间添加dataservice.billdataservice.BillDataService 接口。SaleBillCreation,FinanceBillCreation,StockBillCreation都继承自BillCreation用于处理不同性质的单据创建。BillList和BillListItem的添加是单据记录的容器类。SpecialSettlement是一个接口，为销售单提供特殊的优惠结算方法，创建销售单时BillList继承该接口。BillPO是作为单据记录的持久化对象被添加到设计模型中的。CommodityInfo,UserInfo,AccountInfo,PromotionInfo,CustomerInfo都是根据接口最小化原则，用作从其他BL模块获取数据的接口。
billbl模块的设计如图4-1-6-1所示。
<center>![Alt text](./BillBLClass.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-1 billbl模块各个类的设计</div>
billbl模块各个类的职责如表1所示。
<table>
    <tr>
        <td colspan="2"><strong><div class="text" style=" text-align:center;">表4-1-6-1 billbl模块各个类的职责</div></strong></td>
    </tr>
    <tr>
        <td><strong><div class="text" style=" text-align:center;">模块</div></strong></td>
        <td><strong><div class="text" style=" text-align:center;">职责</div></strong></td>
    </tr>
    <tr>
        <td>BillCreation</td>
        <td>单据制定的领域模型对象，持有单据的编号、操作人、详细内容、状态等通用信息，和制定单据的通用方法，可以帮助完成单据制定所需要的服务</td>
    </tr>
    <tr>
        <td>SaleBillCreation</td>
        <td>进销类单据制定的领域模型对象，持有从父类继承的单据通用信息，包括单据编号、操作人、单据状态等，此外还持有销售类单据的特征信息，包括客户、商品、促销、总价等，可以帮助完成销售类单据制定所需服务</td>
    </tr>
     <tr>
        <td>StockBillCreation</td>
        <td>库存类单据制定的领域模型对象，持有从父类继承的单据通用信息，包括单据编号、操作人、单据状态等，此外还持有库存类单据的特征信息，包括商品、数量等，可以帮助完成库存类单据制定所需服务</td>
    </tr>
     <tr>
        <td>FinanceBillCreation</td>
        <td>财务类单据制定的领域模型对象，持有从父类继承的单据通用信息，包括单据编号、操作人、单据状态等，此外还持有财务类单据的特征信息，包括账户、金额等，可以帮助完成财务类单据制定所需服务</td>
    </tr>
     <tr>
        <td>BillList</td>
        <td>负责实现单据制定的表单结算需要的服务</td>
    </tr>
     <tr>
        <td>SpecialSettlement</td>
        <td>负责实现销售单据特殊优惠结算需要的服务</td>
    </tr>
   <tr>
        <td>BillListItem</td>
        <td>负责实现单据制定的表单项结算需要的服务</td>
    </tr> 
    <tr>
        <td>BillManagement</td>
        <td>负责实现单据管理所需要的服务</td>
    </tr>
    <tr>
        <td>BillSearch</td>
        <td>负责实现查找单据所需要的服务</td>
    </tr>
</table>

#### 4.1.6.3 模块内部类的接口规范
<table>
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的接口（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">CashCostBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该现金费用单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(CashCostBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的现金费用单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的现金费用单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过现金费用单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过现金费用单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.getCashCostBillPOsByDate</td>
        <td>语法</td>
        <td>public ArrayList<CashCostBillPO> getCashCostBillPOsByDate(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据时间查找现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的现金费用单list</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">CashCostBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
    <tr>
        <td rowspan="3">ChangeBill.getBillName</td>
        <td>语法</td>
        <td>public String getBillName()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建报溢报损单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该报溢/报损单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(ChangeBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的报溢/报损单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找报溢/报损单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的报溢/报损单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过报溢/报损单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过报溢/报损单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲报溢/报损单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">ChangeBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制报溢/报损单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	<tr>
        <td rowspan="3">GiftBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过赠品单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">GiftBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过赠品单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">GiftBill.createAndCommitl</td>
        <td>语法</td>
        <td>public boolean createAndCommit(MyTableModel gifts, String salesBillId, String customerId) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动新建赠品单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及到的数据</td>
    </tr>
	    <tr>
        <td rowspan="3">PaymentBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建付款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该付款单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(PaymentBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的付款单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找付款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的付款单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过付款单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过付款单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲付款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">PaymentBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制付款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该进货单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(PurchaseBilllVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的进货单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的进货单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过进货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过进货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.getPurchaseBillPOsByDate</td>
        <td>语法</td>
        <td>public ArrayList<PurchaseBillPO> gePurchaseBillPOsByDate(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据时间查找进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的进货单list</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建进货退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该进货退货单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(PurchaseReturnBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的进货退货单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找进货退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的进货退货单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过进货退货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过进货退货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.getPurchaseReturnBillPOsByDate</td>
        <td>语法</td>
        <td>public ArrayList<PurchaseReturnBillPO> getPurchaseReturnBillPOsByDate(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据时间查找进货退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的进货退货单list</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲进货退货单费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">PurchaseReturnBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制进货退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	   </tr>
	    <tr>
        <td rowspan="3">ReceiptBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建收款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该收款单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(ReceiptBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的收款单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找收款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的收款单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过收款单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过收款单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBilll.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲收款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">ReceiptBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制收款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该销售单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(SalesBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的销售单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的销售单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.examineBill</td>
        <td>语法</td>
        <td>public boolean SalesBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过销售单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过销售单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBillBill.getSalesBillBillPOsByDate</td>
        <td>语法</td>
        <td>public ArrayList<SalesBillBillPO> geSalesBillBillPOsByDate(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据时间查找销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的销售单list</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBillBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesBill.getBestPromotion</td>
        <td>语法</td>
        <td>public PromotionVO getBestPromotion(int rank, MyTableModel goods, double sum) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>创建新的销售单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回匹配的最佳优惠策略</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.getNewId</td>
        <td>语法</td>
        <td>public String getNewId()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>开始新建销售退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该单据对应的唯一编号</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>该销售退货单已存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除该单据，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.saveBill</td>
        <td>语法</td>
        <td>public boolean saveBill(SalesReturnBillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建新的销售退货单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>保存该单据为SAVE状态，持久化更新涉及的数据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找销售退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的销售退货单的VO对象</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务通过销售退货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动单据审批任务不通过销售退货单审批</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>持久化更新被审批单据的状态</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.getSalesReturnBillPOsByDate</td>
        <td>语法</td>
        <td>public ArrayList<SalesReturnBillPO> getSalesReturnBillPOsByDate(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据时间查找销售退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的销售退货单list</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲销售退货单费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲该单据</td>
    </tr>
	<tr>
        <td rowspan="3">SalesReturnBill.copytBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制销售退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制该单据</td>
    </tr>
    <tr>
        <td rowspan="3">BillExamine.examineBill</td>
        <td>语法</td>
        <td>public boolean examineBill(String billId) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动审批单据的通过审批任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回单据审批结果</td>
    </tr>
    <tr>
        <td rowspan="3">BillExamine.notPassBill</td>
        <td>语法</td>
        <td>public boolean notPassBill(String billId) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动审批单据的不通过审批任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回单据审批结果</td>
    </tr>
	<tr>
        <td rowspan="3">BillOperation.offsetBill</td>
        <td>语法</td>
        <td>public boolean offsetBill(String billId)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲单据任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>红冲选中的单据</td>
    </tr>
	<tr>
        <td rowspan="3">BillOperation.copyBill</td>
        <td>语法</td>
        <td>public boolean copyBill(BillVO bill)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动红冲并复制单据任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>复制选中的单据</td>
    </tr>
	<tr>
        <td rowspan="3">BillOperation.deleteBill</td>
        <td>语法</td>
        <td>public boolean deleteBill(String billId) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动删除单据任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除选中的单据，持久化更新涉及到的数据</td>
    </tr>
	<tr>
        <td rowspan="3">BillOperation.getBillById</td>
        <td>语法</td>
        <td>public BillVO getBillById(String billId)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动根据id查找单据任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回根据id查找到的对应的单据信息</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.getBillTable</td>
        <td>语法</td>
        <td>public MyTableModel getBillTable(UserVO user)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>用户登录成功</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该用户制定的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterInventoryBills</td>
        <td>语法</td>
        <td> public MyTableModel filterInventoryBills(String from, String to, String store, String operatorId, boolean isOver, int state)   </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询报溢报损单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterPurchaseBills</td>
        <td>语法</td>
        <td> public MyTableModel filterPurchaseBills(String from, String to, String customerId, String operatorId, int state)   </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询进货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterPurchaseReturnBills</td>
        <td>语法</td>
        <td> public MyTableModel filterPurchaseReturnBills(String from, String to, String customerId, String operatorId, int state)   </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询进货退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterSalesBills</td>
        <td>语法</td>
        <td> public MyTableModel filterSalesBills(String from, String to, String customerId, String operatorId, int state)   </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询销售单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterSalesReturnBills</td>
        <td>语法</td>
        <td> public MyTableModel filterSalesReturnBills(String from, String to, String customerId, String operatorId, int state)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询销售退货单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterCashCostBills</td>
        <td>语法</td>
        <td> public MyTableModel filterCashCostBills(String from, String to, String accountId, String operatorId, int state) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询现金费用单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterPaymentBills</td>
        <td>语法</td>
        <td> public MyTableModel filterPaymentBills(String from, String to, String customerId, String operatorId, int state)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询付款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterReceiptBills</td>
        <td>语法</td>
        <td> public MyTableModel filterReceiptBills(String from, String to, String customerId, String operatorId, int state)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询收款单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterGiftBills</td>
        <td>语法</td>
        <td> public MyTableModel filterGiftBills(String from, String to, String customerId, int state) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询赠品单任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
	<tr>
        <td rowspan="3">BillSearch.filterBills</td>
        <td>语法</td>
        <td> public MyTableModel filterBills(String from, String to)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动按时间查询单据任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合查询条件的单据列表</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>CashCostBillDataService.saveBill(CashCostBillPO bill)</td>
        <td>增加一个持久化现金费用单对象</td>
    </tr>
	<tr>
        <td>CashCostBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化现金费用单对象</td>
    </tr>
	<tr>
        <td>CashCostBillDataService.getNewId()</td>
        <td>返回自动生成的新建现金费用单对应的唯一id</td>
    </tr>
	<tr>
        <td>CashCostBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一现金费用单持久化对象</td>
    </tr>
    <tr>
        <td>CashCostBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的现金费用单持久化对象list</td>
    </tr>
    <tr>
        <td>ChangeBillDataService.saveBill(ChangetBillPO bill)</td>
        <td>增加一个持久化报溢/报损单对象</td>
    </tr>
	<tr>
        <td>ChangeBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化报溢/报损单对象</td>
    </tr>
	<tr>
        <td>ChangeBillDataService.getNewId()</td>
        <td>返回自动生成的新建报溢/报损单对应的唯一id</td>
    </tr>
	<tr>
        <td>ChangeBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一报溢/报损单持久化对象</td>
    </tr>
    <tr>
        <td>ChangeBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的报溢/报损单持久化对象list</td>
    </tr>
    <tr>
        <td>GiftBillDataService.add(GiftBillPO bill)</td>
        <td>增加一个持久化赠品单对象</td>
    </tr>
	<tr>
        <td>GiftBillDataService.getNewId()</td>
        <td>返回自动生成的新建赠品单对应的唯一id</td>
    </tr>
	<tr>
        <td>GiftBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一赠品单持久化对象</td>
    </tr>
    <tr>
        <td>PaymentBillDataService.saveBill(PaymentBillPO bill)</td>
        <td>增加一个持久化付款单对象</td>
    </tr>
	<tr>
        <td>PaymentBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化付款单对象</td>
    </tr>
	<tr>
        <td>PaymentBillDataService.getNewId()</td>
        <td>返回自动生成的付款单对应的唯一id</td>
    </tr>
	<tr>
        <td>PaymentBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一付款单持久化对象</td>
    </tr>
    <tr>
        <td>PaymentBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的付款单持久化对象list</td>
    </tr>
    <tr>
        <td>PurchaseBillDataService.saveBill(PurchaseBillPO bill)</td>
        <td>增加一个持久化进货单对象</td>
    </tr>
	<tr>
        <td>PurchaseBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化进货单对象</td>
    </tr>
	<tr>
        <td>PurchaseBillDataService.getNewId()</td>
        <td>返回自动生成的进货单对应的唯一id</td>
    </tr>
	<tr>
        <td>PurchaseBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一进货单持久化对象</td>
    </tr>
    <tr>
        <td>PurchaseBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的进货单持久化对象list</td>
    </tr>
    <tr>
        <td>PurchaseBillDataService.getBillsBy(String field, String key, boolean isfuzzy)</td>
        <td>返回根据关键词查找的进货单持久化对象list</td>
    </tr>
    <tr>
        <td>PurchaseReturnBillDataService.saveBill(PurchaseReturnBillPO bill)</td>
        <td>增加一个持久化进货退货单对象</td>
    </tr>
	<tr>
        <td>PurchaseReturnBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化进货退货单对象</td>
    </tr>
	<tr>
        <td>PurchaseReturnBillDataService.getNewId()</td>
        <td>返回自动生成的进货退货单对应的唯一id</td>
    </tr>
	<tr>
        <td>PurchaseReturnBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一进货退货单持久化对象</td>
    </tr>
    <tr>
        <td>PurchaseReturnBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的进货退货单持久化对象list</td>
    </tr>
    <tr>
        <td>ReceiptBillDataService.saveBill(ReceiptBillPO bill)</td>
        <td>增加一个持久化收款单对象</td>
    </tr>
	<tr>
        <td>ReceiptBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化收款单对象</td>
    </tr>
	<tr>
        <td>ReceiptBillDataService.getNewId()</td>
        <td>返回自动生成的收款单对应的唯一id</td>
    </tr>
	<tr>
        <td>ReceiptBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一收款单持久化对象</td>
    </tr>
    <tr>
        <td>ReceiptBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的收款单持久化对象list</td>
    </tr>	
    <tr>
        <td>SalesBillDataService.saveBill(SalesBillPO bill)</td>
        <td>增加一个持久化销售单对象</td>
    </tr>
	<tr>
        <td>SalesBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化销售单对象</td>
    </tr>
	<tr>
        <td>SalesBillDataService.getNewId()</td>
        <td>返回自动生成的销售单对应的唯一id</td>
    </tr>
	<tr>
        <td>SalesBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一销售单持久化对象</td>
    </tr>
    <tr>
        <td>SalesBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的销售单持久化对象list</td>
    </tr>
    <tr>
        <td>SalesBillDataService.getBillsBy(String field, String key, boolean isfuzzy)</td>
        <td>返回根据关键词查找的销售单持久化对象list</td>
    </tr>
    <tr>
        <td>SalesReturnBillDataService.saveBill(SalesReturnBillPO bill)</td>
        <td>增加一个持久化销售退货单对象</td>
    </tr>
	<tr>
        <td>SalesReturnBillDataService.deleteBill(String billid)</td>
        <td>删除一个持久化销售退货单对象</td>
    </tr>
	<tr>
        <td>SalesReturnBillDataService.getNewId()</td>
        <td>返回自动生成的销售退货单对应的唯一id</td>
    </tr>
	<tr>
        <td>SalesReturnBillDataService.getBillById(String id)</td>
        <td>返回根据id查找到的唯一销售退货单持久化对象</td>
    </tr>
    <tr>
        <td>SalesReturnBillDataService.getBillsByDate(String from, String to)</td>
        <td>返回根据时间查找的销售退货单持久化对象list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.getBillList(UserPO user)</td>
        <td>返回该用户创建的单据list</td>
    </tr>	 
     <tr>
        <td>BillSearchDataService.searchPurchaseBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的进货单list</td>
    </tr>	 	
     <tr>
        <td>BillSearchDataService.searchPurchaseReturnBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的进货退货单list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.searchSalesBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的销售单list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.searchSalesReturnBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的销售退货单list</td>
    </tr>		
     <tr>
        <td>BillSearchDataService.searchCashCostBills(String fromDate, String toDate, String customerId, String operatorId, int state) </td>
        <td>返回符合条件的现金费用单list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.searchChangeBills(String fromDate, String toDate, String store, String operatorId, boolean isOver,int state) </td>
        <td>返回符合条件的报溢/报损单list</td>
    </tr>		
     <tr>
        <td>BillSearchDataService.searchPaymentBills(String fromDate, String toDate, String customerId, String operatorId, int state)</td>
        <td>返回符合条件的付款单list</td>
    </tr>		
     <tr>
        <td>BillSearchDataService.searchReceiptBills(String fromDate, String toDate, String customerId, String operatorId, int state)</td>
        <td>返回符合条件的收款单list</td>
    </tr>		
     <tr>
        <td>BillSearchDataService.searchGiftBills(String fromDate, String toDate, String customerId, int state)</td>
        <td>返回符合条件的赠品单list</td>
    </tr>		
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>
#### 4.1.6.4 业务逻辑层动态模型  

图4-1-6-2表明了njuERP系统中,创建一张销售单据后，单据制定业务逻辑处理的相关对象之间的协作。(其余单据的制定与之类似，都是在制定单据时调用需要更新的对象的BillCreation进行操作)
<center>![Alt text](./SaleBillCreationSd.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-2 制定销售单的顺序图</div>

图4-1-6-3表明了njuERP系统中,创建一张财务类单据后，单据制定业务逻辑处理的相关对象之间的协作。(其余单据的制定与之类似，都是在制定单据时调用需要更新的对象的BillCreation进行操作)
<center>![Alt text](./FinanceBillCreationSd.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-3 制定财务类单据的顺序图</div>

图4-1-6-4表明了njuERP系统中,创建一张库存类单据后，单据制定业务逻辑处理的相关对象之间的协作。(其余单据的制定与之类似，都是在制定单据时调用需要更新的对象的BillCreation进行操作)
<center>![Alt text](./StockBillCreationSd.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-4 制定库存类单据的顺序图</div>

图4-1-6-5表明了njuERP系统中,删除单据时，单据管理业务逻辑处理的相关对象之间的协作。(其余单据管理与之类似，都是在管理单据时调用需要更新的对象的BillManagement进行操作)
<center>![Alt text](./BillManagementDeleteSd.png)</center>
 
<div class="text" style=" text-align:center;">图4-1-6-5 删除单据的顺序图</div>


图4-1-6-6表明了njuERP系统中,审批单据时，单据管理业务逻辑处理的相关对象之间的协作。(其余单据管理与之类似，都是在管理单据时调用需要更新的对象的BillManagement进行操作)
<ceneter>![Alt text](./BillManagementExamineSd.png)</center>
 
<div class="text" style=" text-align:center;">图4-1-6-6 审批单据的顺序图</div>


图4-1-6-7表明了njuERP系统中,红冲单据时，单据管理业务逻辑处理的相关对象之间的协作。(其余单据管理与之类似，都是在管理单据时调用需要更新的对象的BillManagement进行操作)
<center>![Alt text](./BillManagementOffsetSd.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-7 红冲单据的顺序图</div>

图4-1-6-8表明了njuERP系统中,按编号查找单据时，单据查找业务逻辑处理的相关对象之间的协作。(其余单据查找与之类似，都是在查找单据时调用需要更新的对象的BillSearch进行操作)
<center>![Alt text](./BillSearchFindByIdSd.png)</center>
 
<div class="text" style=" text-align:center;">图4-1-6-8 按编号查找单据的顺序图</div>

图4-1-6-9表明了njuERP系统中,按时间查找单据时，单据查找业务逻辑处理的相关对象之间的协作。(其余单据查找与之类似，都是在查找单据时调用需要更新的对象的BillSearch进行操作)
<center>![Alt text](./BillSearchFindByTimeSd.png)</center>
<div class="text" style=" text-align:center;">图4-1-6-9 按时间查找单据的顺序图</div>

图4-1-6-10表明了njuERP系统中,查找所有单据时，单据查找业务逻辑处理的相关对象之间的协作。(其余单据查找与之类似，都是在查找单据时调用需要更新的对象的BillSearch进行操作)
<center>![Alt text](./BillSearchGetAllSd.png)</center>
 
<div class="text" style=" text-align:center;">图4-1-6-10 查找所有单据的顺序图</div>

如图4-1-6-11所示的状态图描述了BillCreation对象的生存期间执行制定单据操作的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getBillId 方法被UI调用，BillCreation进Input状态，然后如果输入info合法正确，则进入BillInfo状态，然后进行表单项添加，则进入addListItem状态。如果添加完成，选择结算，则进入结算状态并返回结果。最后如果确认保存或提交则进入end状态。如果用户取消，则进入end状态。
<center>![Alt text](./BillCreationStm.png)</center>
 
<div class="text" style=" text-align:center;">图4-1-6-11 BillCreation对象执行制定单据操作的状态图</div>

如图4-1-6-12所示的状态图描述了BillManagement对象的生存期间执行删除单据信息操作的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果deleteBill方法被UI调用，BillManagement进入BillList状态，然后choose方法被UI调用，BillManagement进入BillInfo状态，然后deleteBill方法被调用，进入Confirm状态，如果用户确认则进入end状态，如果取消则返回BillInfo状态。在BillInfo状态如果用户返回，则返回BillList状态。如果取消，则进入end状态。
<center>![Alt text](./BillManagementDeleteStm.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-12 BillManagement对象执行删除单据操作的状态图</div>

如图4-1-6-13所示的状态图描述了BillManagement对象的生存期间执行更新单据操作的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果updateBill方法被UI调用，BillManagement进入Input状态，然后如果输入 info合法正确，则进入ReceiptInfo状态，然后如果用户确认，则进入end状态。如果输入非法，则返回Input状态并提示。如果用户取消，则进入end状态。
<center>![Alt text](./BillManagementUpdateStm.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-13 BillManagement对象执行更新单据操作的状态图</div>

如图4-1-6-14所示的状态图描述了BillManagement对象的生存期间执行审批单据操作的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果examineBill方法被UI调用，BillManagement进入Input状态，然后如果输入info合法正确，则进入BillInfo状态，然后如果总经理通过审批，则进入Approved状态，最后如果总经理确认，则进入end状态。如果输入非法，则返回Input状态并提示。如果总经理没有通过审批，则直接进入end状态。如果总经理不确定，则返回ReceiptInfo状态。如果用户取消，则进入end状态。
<center>![Alt text](./BillManagementExamineStm.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-14 BillManagement对象执行审批单据操作的状态图</div>

如图4-1-6-15所示的状态图描述了BillSearch对象的生存期间执行查询单据操作的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果findByID 方法被UI调用，Bill进入Input状态，然后如果输入ID合法正确，则进入BillInfo状态，然后如果用户确认，则进入end状态。如果用户再次调用findByID方法，则返回Input状态。如果输入非法，则停留在Input状态并提示。如果用户取消，则进入end状态。
<center>![Alt text](./BillSearchSTM.png)</center>

<div class="text" style=" text-align:center;">图4-1-6-15 BillSearch对象执行查找单据操作的状态图</div>

#### 4.1.7 initBL模块

#### 4.1.7.1 模块概述
initBL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
initBL模块的职责及接口参见体系结构设计文档。  

#### 4.1.7.2 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加initBLService接口。业务逻辑层和数据层之间添加initDataService接口。initPO是作为期初数据的持久化对象添加到设计模型中去的。在期初建账的时候，InitBL需要知道上一期末的商品信息、客户信息、账户信息等，因此需要CommodityInfo、AccountInfo、CustomerInfo、CategoryInfo接口获取这些信息。  
InitBL模块的设计如图4-1-7-1所示  
<center>![Alt text](./InitBLClass.png)</center>
  
<center>图4-1-7-1  InitBL模块各个类的设计</center>  
InitBL模块的各个类的职责如表4-1-7-1所示   
<center>表4-1-7-1  InitBL模块各个类的职责</center>  

|模块|职责|
|---|---|
|InitBL|负责实现期初建账界面所需要的服务|

#### 4.1.7.3 模块内部类的接口规范
InitBL的接口规范如表4-1-7-3所示  
<table>
    <tr>
    <caption>表4-1-7-3 Initbl模块的接口规范 </caption>  
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Init.getYear</td>
        <td>语法</td>
        <td>public String getYear()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动期初信息查询任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>得到期初信息对应的年份</td>
    </tr>
    <tr>
        <td rowspan="3">Init.getInitInfo</td>
        <td>语法</td>
        <td>public String[] getInitInfo()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>进入期初建账界面</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回当前一期期初信息</td>
    </tr>
    <tr>
        <td rowspan="3">Init.getCommodityInfo</td>
        <td>语法</td>
        <td>public MyTableModel getCommodityInfo(String year)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>设定好期初信息的查询日期</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回对应的商品信息</td>
    </tr>
    <tr>
        <td rowspan="3">Init.getCustomerInfo</td>
        <td>语法</td>
        <td>public MyTableModel getCustomerInfo(String year)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>设定好期初信息的查询日期</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回对应的客户信息</td>
    </tr>
    <tr>
        <td rowspan="3">Init.getAccountInfo</td>
        <td>语法</td>
        <td>public MyTableModel getAccountInfo(String year)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>设定好期初信息的查询日期</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回对应的账户信息</td>
    </tr>
    <tr>
        <td rowspan="3">Init.initNewOne()</td>
        <td>语法</td>
        <td>public boolean initNewOne()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动期初建账任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回建立好的一套新账</td>
    </tr>
</table>

<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>InitDataService.getYear()</td>
        <td>得到特定InitPO记录所对应的年份</td>
    </tr>
    <tr>
        <td>InitDataService.getInitInfo()</td>
        <td>得到当前账套</td>
    </tr>
    <tr>
        <td>InitDataService.initNewOne()</td>
        <td>期初信息初始化</td>
    </tr>
    <tr>
        <td>InitDataService.getCommodityInfo(String year)</td>
        <td>得到相关商品信息</td>
    </tr>
    <tr>
        <td>InitDataService.getCustomerInfo(String year)</td>
        <td>得到相关客户信息</td>
    </tr>
    <tr>
        <td>InitDataService.getAccountInfo(String year)</td>
        <td>得到相关账户信息</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>

#### 4.1.7.4 业务逻辑层的动态模型
图4-1-7-2表明了进销存管理系统中，查看期初信息的业务逻辑处理的相关对象之间的协作。  
<center>![Alt text](./InitBLModel1.png)</center>

<center>图4-1-7-2  查看往期期初信息的顺序图</center>
图4-1-7-3表明了进销存管理系统中，期初建账的业务逻辑处理的相关对象之间的协作。  
<center>![Alt text](./InitBLModel2.png)</center>

<center>图4-1-7-3  期初建账的顺序图</center>
如图4-1-7-4所示的状态图描述了InitBL对象在执行查看期初信息任务时的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果check方法被UI调用，进入Input状态，如果用户输入正确格式的年份，进入showInitInfo状态，之后等待用户操作进入结束状态   
<center>![Alt text](./InitBLModel3.png)</center>

<center>图4-1-7-4  InitBL对象执行查看期初信息状态图</center>
如图4-1-7-5所示的状态图描述了InitBL对象在执行期初建账任务的生存期间的状态序列，引起转移的事件和因状态转移而伴随的动作。如果add方法被UI调用，进入check状态，系统依次调用CommodityInfo、AccountInfo、CustomerInfo、CategoryInfo接口中的get方法获取信息，如果信息不全则进入建账失败的fail状态，否则进入save状态，之后退出期初建账过程进入结束状态。  
<center>![Alt text](./InitBLModel4.png)</center>
  
<center>图4-1-7-5  InitBL对象执行期初建账状态图</center>

#### 4.1.8 LogBL模块
#### 4.1.8.1 模块概述
BL模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
BL模块的职责及接口参见体系结构设计文档。  

#### 4.1.8.2 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加LogBLService接口。业务逻辑层和数据层之间添加LogDataService接口。LogPO是作为操作信息的持久化对象添加到设计模型中去的。  
LogBL模块的设计如图4-1-8-1所示  
![Alt text](./LogBLClass.png)
![](doc/img/DesignDiagrams/LogBLClass.png)  
<center>图4-1-8-1  LogBL模块各个类的设计</center>  
LogBL模块的各个类的职责如表4-1-8-1所示   
<center>表4-1-8-1  LogBL模块各个类的职责</center>  

|模块|职责|
|---|---|
|LogBL|负责实现查看日志界面所需要的服务|

#### 4.1.8.3 模块内部类的接口规范
LogBL的接口规范如表4-1-8-3所示  
<table>
<caption>表4-1-8-3 Logbl模块的接口规范 </caption>  
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Log.getLogInfo</td>
        <td>语法</td>
        <td>public MyTableModel getLogInfo() </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td> 操作人员已被授权  </td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有操作记录</td>
    </tr>
    <tr>
        <td rowspan="3">Log.searchByTime</td>
        <td>语法</td>
        <td>public MyTableModel searchByTime(String startTime, String endTime) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td> 操作人员根据时间查询操作记录  </td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一段时间内的操作记录</td>
    </tr>
    <tr>
        <td rowspan="3">Log.add</td>
        <td>语法</td>
        <td>public boolean add(String operation, String detail) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>操作人员进行新的操作</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加一条操作记录</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>增加一条持久化LogPO记录</td>
    </tr>
    <tr>
        <td>LogDataService.getAllInfo(String startTime, String EndTime)</td>
        <td>得到一段时间内全部持久化LogPO记录</td>
    </tr>
    <tr>
        <td>LogDataService.getAllInfo()</td>
        <td>得到全部持久化LogPO记录</td>
    </tr>
</table>
#### 4.1.8.4 业务逻辑层的动态模型
图4-1-8-2表明了进销存管理系统中，查询操作日志的业务逻辑处理的相关对象之间的协作。  
<center>  ![Alt text](./LogBLModel1.png)</center>  

<center>图4-1-8-2  查询操作日志的顺序图</center>  
图4-1-8-3表明了进销存管理系统中，增加操作记录的业务逻辑处理的相关对象之间的协作。  
<center>  ![Alt text](./LogBLModel2.png)</center>  

<center>图4-1-8-3  增加操作记录的顺序图</center>  
如图4-1-8-4所示的状态图描述了LogBL对象在执行查询操作日志任务时的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果lookUp方法被UI调用，进入getInput状态获取用户选择的起始日期和结束日期，得到查询结果后进入show状态显示查询结果，此时还可以调用lookUp方法再次进行查询操作。show状态后自动进入结束状态。  
<center>  ![Alt text](./LogBLModel3.png)</center>  
   
如图4-1-8-4所示的状态图描述了LogBL对象在执行增加操作记录任务时的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果createLogInfo方法被其他BL模块调用，进入getInfo状态获取操作信息，再进入addInfo状态添加LogVO并持久化，成功后自动进入结束状态。  
<center>  ![Alt text](./LogBLModel4.png)</center>  
   

###4.1.9 analysisbl模块

####4.1.9.1 模块概述
&ensp;&ensp;analysisbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。</br>
&ensp;&ensp;analysisbl模块的职责及接口参见体系结构设计文档
####4.1.9.2 整体结构
&ensp;&ensp;根据体系结构的设计，进销存系统选择分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层），很好地示意了整个高度抽象。展示层包含GUI页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。每一层之间为了增加灵活性，添加了接口，比如在展示层和业务逻辑层之间添加blservice.analysisblservice.AnalysisBLService接口。</br>
&ensp;&ensp;analysisbl模块的设计如图4-1-9-1所示</br>
![](https://i.imgur.com/rClHKFE.png)</br>
<center>图4-1-9-1 analysisbl模块各个类的设计</center></br>
&ensp;&ensp;analysisbl模块各个类的职责如表4-1-9-1所示。
<table>
<caption> 表4-1-9-1 analysisbl模块各个类的职责 </caption>
    <tr>
        <td><strong><div class="text" style=" text-align:center;">模块</div></strong></td>
        <td><strong><div class="text" style=" text-align:center;">职责</div></strong></td>
    </tr>
    <tr>
        <td>analysisBL</td>
        <td>负责实现经营状况统计分析查看界面所需要的服务</td>
    </tr>

</table>
####4.1.9.3 模块内部类的接口规范
&ensp;&ensp;analysisBL的接口规范如表4-1-1-2所示。
<table>
<caption>表4-1-9-2 analysisBL模块的接口规范</caption>  
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showBusinessProcessTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段返回数个单据对象组成的经营历程表格</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showBusinessConditionTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段返回一个给定时间内的盈亏情况对象构成的经营情况表</td>
    </tr>
     <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
     <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String parameter)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的商品名/客户/业务员返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String parameter)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段以及商品名/客户/业务员返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String parameter, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的商品名/客户/业务员以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String parameter1, String parameter2)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段以及商品名、客户、业务员中的两个返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String parameter, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段、商品名/客户/业务员以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String parameter1, String parameter2, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的商品名/客户/业务员中的两个以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String commodityName, String customer, String user)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段、商品名、客户以及业务员返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String parameter1, String parameter2, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段、商品名/客户/业务员中的两个以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String commodityName, String customer, String user, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的商品名、客户、业务员以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.showSalesScheduleTable</td>
        <td>语法</td>
        <td>public DefaultTableModel showBusinessProcessTable &ensp;(String beginTime, String endTime, String commodityName, String customer, String user, int storehouse)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段、商品名、客户、业务员以及仓库返回一个由数个符合条件的销售单和销售退货单构成的销售明细表对象</td>
    </tr>
    <tr>
        <td rowspan="3">analysisBL.checkInventory</td>
        <td>语法</td>
        <td>public DefaultTableModel checkInventory &ensp;(String beginTime, String endTime)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>输入的查找信息符合输入规范</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据给定的时间段返回一个由数个符合条件的进货单，进货退货单，销售单，销售退货单构成的库存查看表对象</td>
    </tr>
</table>
<table>
    <tr>
        <td colspan="2"><strong><div class="text" style=" text-align:center;">需要的接口（需接口）</div></strong></td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
    <tr>
        <td>billBL.lookUp</td>
        <td>返回符合条件的一组单据对象</td>
    </tr>
</table><table>
<caption>表16 Analysisbl模块的接口规范 </caption>  
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">InventoryDynamic.getDynamic</td>
        <td>语法</td>
        <td>public MyTableModel getDynamic(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动库存查看任务，根据时间查询库存情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所查询的库存详细信息</td>
    </tr>
    <tr>
        <td rowspan="3">InventoryDynamic.getDefault</td>
        <td>语法</td>
        <td>public MyTableModel getDefault()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动库存查看任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回默认表头信息</td>
    </tr>	
    <tr>
        <td rowspan="3">SalesDetails.filter</td>
        <td>语法</td>
        <td>public MyTableModel filter(String from, String to, String commodityId
        , String store, String customerId, String operatorId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看销售明细表任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合筛选条件的销售明细信息</td>
    </tr>	
    <tr>
        <td rowspan="3">ViewBusinessSituation.getSalesIncome</td>
        <td>语法</td>
        <td>public double getSalesIncome(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回销售收入</td>
    </tr>		
    <tr>
        <td rowspan="3">ViewBusinessSituation.getCommodityOverflowIncome</td>
        <td>语法</td>
        <td>public double getCommodityOverflowIncome(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回商品报溢收入</td>
    </tr>			
    <tr>
        <td rowspan="3">ViewBusinessSituation.getPurchaseAndReturnIncome</td>
        <td>语法</td>
        <td>public double getPurchaseAndReturnIncome(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回进货退货差价</td>
    </tr>	
    <tr>
        <td rowspan="3">ViewBusinessSituation.getCashCouPonIncome</td>
        <td>语法</td>
        <td>public double getCashCouPonIncome(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回代金券与实际金额差额</td>
    </tr>		
    <tr>
        <td rowspan="3">ViewBusinessSituation.getSalesExpense</td>
        <td>语法</td>
        <td>public double getSalesExpense(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回销售成本</td>
    </tr>	
    <tr>
        <td rowspan="3">ViewBusinessSituation.getCommodityBrokenExpense</td>
        <td>语法</td>
        <td>public double getCommodityBrokenExpense(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回商品报损支出</td>
    </tr>		
    <tr>
        <td rowspan="3">ViewBusinessSituation.getCommoditySentExpense</td>
        <td>语法</td>
        <td>public double getCommoditySentExpense(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回商品赠送支出</td>
    </tr>	
    <tr>
        <td rowspan="3">ViewBusinessSituation.fillIncomeTable</td>
        <td>语法</td>
        <td>public MyTableModel fillIncomeTable(String from, String to)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回收入类表格</td>
    </tr>	
    <tr>
        <td rowspan="3">ViewBusinessSituation.fillExpenseTable</td>
        <td>语法</td>
        <td>public MyTableModel fillExpenseTable(String from, String to)  </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回支出类表格</td>
    </tr>		
    <tr>
        <td rowspan="3">ViewBusinessSituation.getProfit</td>
        <td>语法</td>
        <td>public double getProfit(String from, String to) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查看经营情况表任务，根据时间查看经营情况</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回利润</td>
		</tr>	
</table>

<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
        <tr>
        <td>BillSearchDataService.searchPurchaseBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的进货单list</td>
    </tr>	 	
     <tr>
        <td>BillSearchDataService.searchPurchaseReturnBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的进货退货单list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.searchSalesBills(String fromDate, String toDate , String customerId, String operatorId, int state) </td>
        <td>返回符合条件的销售单list</td>
    </tr>
     <tr>
        <td>BillSearchDataService.searchChangeBills(String fromDate, String toDate, String store, String operatorId, boolean isOver,int state) </td>
        <td>返回符合条件的报溢/报损单list</td>
    </tr>	
     <tr>
        <td>BillSearchDataService.searchGiftBills(String fromDate, String toDate, String customerId, int state)</td>
        <td>返回符合条件的赠品单list</td>
    </tr>		
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>
####4.1.9.4 业务逻辑层的动态模型
&ensp;&ensp;图4-1-1-2表明了进销存系统中，在展示经营历程表的过程中输入一个时间段的信息后，统计分析管理业务逻辑处理的相关对象之间的协作。（展示库存情况、展示经营情况表、展示销售明细表的顺序图都与此类似）</br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;![](https://i.imgur.com/m0Ydzpo.png)
<center>图4-1-1-2 显示经营历程表的顺序图</center></br>
&ensp;&ensp;如图4-1-1-3所示的状态图描述了analysisBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果showBusinessProcessTable方法被UI调用，analysisBL进入WaitForInput状态，之后通过input Valid Time Info进入Show Business Process Table状态，最后通过Confirm进入结束状态。（查看经营情况表、查看销售明细表、查看库存的状态图均与此类似）</br>
![](https://i.imgur.com/G7ko30r.png)
<center>图4-1-1-2 显示经营历程表的状态图</center></br>

###4.1.10 promotionbl模块

####4.1.10.1 模块概述
&ensp;&ensp;promotionbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
&ensp;&ensp;promotionbl模块的职责及接口参见体系结构设计文档  

####4.1.10.2 整体结构
&ensp;&ensp;根据体系结构的设计，进销存系统选择分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层），很好地示意了整个高度抽象。展示层包含GUI页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。每一层之间为了增加灵活性，添加了接口，比如在展示层和业务逻辑层之间添加blservice.promotionblservice.PromotionBLService接口，在业务逻辑层和数据层之间添加dataservice.promotiondataservice.PromotionDataService接口。PromotionPO是作为促销策略的持久化对象被添加到设计模型中去的。</br>
&ensp;&ensp;promotionbl模块的设计如图4-1-10-1所示</br>
![](https://i.imgur.com/DlAhZip.png)</br>
<center>图4-1-10-1 promotionbl模块各个类的设计</center></br>
&ensp;&ensp;promotionbl模块各个类的职责如表4-1-1-1所示。
<table>
<caption> 表4-1-10-1 promotionbl模块各个类的职责 </caption>
    <tr>
        <td><strong><div class="text" style=" text-align:center;">模块</div></strong></td>
        <td><strong><div class="text" style=" text-align:center;">职责</div></strong></td>
    </tr>
    <tr>
        <td>promotionBL</td>
        <td>负责促销策略管理界面所需要的服务</td>
    </tr>

</table>

####4.1.10.3 模块内部类的接口规范
&ensp;&ensp;promotionBL的接口规范如表4-1-10-2所示。
<table>
<caption>表4-1-10-2 Promotionbl模块的接口规范 </caption>  
    <tr>
        <td colspan="3"><strong><div class="text" style=" text-align:center;">提供的服务（供接口）</div></strong></td>
    </tr>
    <tr>
        <td rowspan="3">Promotion.findById</td>
        <td>语法</td>
        <td>public PromotionVO findById(String id) </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询根据id促销策略任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该id对应的唯一促销策略</td>
    </tr>
    <tr>
        <td rowspan="3">Promotion.searchPromotion</td>
        <td>语法</td>
        <td>public MyTableModel searchPromotion(String from, String to)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动查询促销策略任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回符合条件的促销策略列表</td>
    </tr>
    <tr>
        <td rowspan="3">Promotion.getNewId</td>
        <td>语法</td>
        <td>public String getNewId() throws RemoteException </td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动促销策略制定任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回自动生成的该促销策略对应的唯一id</td>
    </tr>
    <tr>
        <td rowspan="3">Promotion.add</td>
        <td>语法</td>
        <td>public boolean add(PromotionStrategyVO new_strategy)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>启动销售策略制定任务</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加新销售策略，持久化更新所涉及的数据</td>
    </tr>
    <tr>
        <td rowspan="3">Promotion.delete</td>
        <td>语法</td>
        <td>publicboolean delete(PromotionStrategyVO strategy)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>此促销策略存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除促销策略，返回删除信息，持久化更新所涉及的数据</td>
    </tr>
</table>

<table>
    <tr>
        <td colspan="2">需要的接口（需接口）</td>
    </tr>
    <tr>
        <td>服务名</td>
        <td>服务</td>
    </tr>
   <tr>
        <td>PromotionDataService.getNewId()</td>
        <td>得到自动生成的当前促销策略的唯一id</td>
    </tr>
    <tr>
        <td>PromotionDataService.findById(string id)</td>
        <td>根据id查找单一持久化PromotionPO记录</td>
    </tr>
    <tr>
        <td>PromotionDataService.searchPromotion(String from, String to)</td>
        <td>得到符合条件的PromotionPO记录</td>
    </tr>
     <tr>
        <td>PromotionDataService.add(PromotionPO ppo)</td>
        <td>插入单一持久化PromotionPO记录</td>
    </tr>
     <tr>
        <td>PromotionDataService.delete(String id)</td>
        <td>删除单一持久化PromotionPO记录</td>
    </tr>
    <tr>
        <td>PromotionDataService.update(PromotionPO ppo)</td>
        <td>更新单一持久化PromotionPO记录</td>
    </tr>
     <tr>
        <td>LogDataService.add(LogInfoPO logInfo)</td>
        <td>添加一个持久化LogPO记录</td>
    </tr>
</table>


####4.1.10.4 业务逻辑层的动态模型
&ensp;&ensp;图4-1-10-2表明了进销存系统中，在增加一个新的促销策略的过程中输入一个促销策略的详情信息后，促销策略管理业务逻辑处理的相关对象之间的协作。
![](https://i.imgur.com/pUs3wJz.png)</br>
<center>图4-1-10-2 增加新促销策略的顺序图</center></br>
&ensp;&ensp;图4-1-10-3表明了在进销存系统中，在删除一个促销策略的过程中输入一个促销策略对象的id之后，促销策略管理业务逻辑处理的相关对象之间的协作。</br>
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;![](https://i.imgur.com/TmM5Eml.png)</br>
<center>图4-1-10-3 删除促销策略的顺序图</center></br>
&ensp;&ensp;图4-1-10-4表明了进销存系统中，在修改一个已有的促销策略的过程中输入一个促销策略的详情信息之后，促销策略管理业务逻辑处理的相关对象之间的协作。
![](https://i.imgur.com/VzpH3bb.png)</br>
<center>图4-1-10-4 修改促销策略的顺序图</center></br>
&ensp;&ensp;图4-1-10-5表明了进销存系统中，在查看一个已有的促销策略详情的过程中输入一个促销策略的id之后，促销策略管理业务逻辑处理的相关对象之间的协作。
![](https://i.imgur.com/KCM214l.png)</br>
<center>图4-1-10-5 查看促销策略详情的顺序图</center></br>
&ensp;&ensp;图4-1-10-6表明了进销存系统中，在查找已有的促销策略的过程中输入一个促销策略的id/类别之后，促销策略管理业务逻辑处理的相关对象之间的协作。
![](https://i.imgur.com/Wy7k1zs.png)</br>
<center>图4-1-10-6 查找促销策略的顺序图</center></br>
&ensp;&ensp;如图4-1-10-7所示的状态图描述了promotionBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果new方法被UI调用，promotionBL进入WaitForInput状态，之后通过input Valid Info进入new Promotion Strategy状态，最后通过Confirm进入结束状态。在WaitForInput状态也可以通过Cancel直接进入结束状态。
![](https://i.imgur.com/sARv4Kr.png)</br>
<center>图4-1-10-7 增加新促销策略的状态图</center></br>
&ensp;&ensp;如图4-1-10-8所示的状态图描述了promotionBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果update方法被UI调用，promotionBL进入WaitForInput状态，之后通过input Valid Info进入new Promotion Strategy状态，最后通过Confirm进入结束状态。在WaitForInput状态也可以通过Cancel直接进入结束状态。
![](https://i.imgur.com/e2HneHC.png)</br>
<center>图4-1-10-8 更新促销策略的状态图</center></br>
&ensp;&ensp;如图4-1-10-9所示的状态图描述了promotionBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果find方法被UI调用，promotionBL进入WaitForInput状态，之后通过input Valid Info进入Promotion Strategy Info状态，最后通过Confirm进入结束状态。Promotion Strategy Info状态也可以通过新的调用find方法进入WaitForInput状态。在WaitForInput状态也可以通过Cancel直接进入结束状态。
![](https://i.imgur.com/WBNbV1T.png)</br>
<center>图4-1-10-9 查找促销策略的状态图</center></br>
&ensp;&ensp;如图4-1-10-10所示的状态图描述了promotionBL对象的生存期间的状态序列，引起转移的事件，以及因状态转移而伴随的动作。如果getInfo方法被UI调用，promotionBL进入WaitForInput状态，之后通过input Valid Info进入Promotion Strategy Detail状态，最后通过exit进入结束状态。Promotion Strategy Info状态也可以通过新的调用getInfo方法进入WaitForInput状态。在WaitForInput状态也可以通过Cancel直接进入结束状态。
![](https://i.imgur.com/wG2X5Kk.png)</br>
<center>图4-1-10-10 查看促销策略详情的状态图</center></br>

### 4.2 界面层的分解

#### 4.2.1 登录模块与主窗体模块

登录模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。  
主窗体模块承担的需求为界面跳转和单据管理，参见需求规格说明文档功能需求及相关非功能需求。  

登录模块需要UserBL提供的LoginBLService服务，来进行用户登录的验证工作，验证通过后将相应的UserVO传递给主窗体模块。  
主窗体模块根据UserVO的用户类型进行界面的初始化工作，包括初始化左侧按钮栏并绑定相应的监听器，初始化欢迎界面和初始化单据管理面板。同时将用户对应的单据信息返回给单据管理面板。  

主窗体左侧的按钮将分别绑定对应的界面面板，这些面板都实现了PanelInterface接口，其中Close方法用于在切换前提示保存未完成工作，getPanel方法用于返回私有的Panel对象实现窗体的切换。同时主窗体持有当前显示的PanelInterface的引用。  

#### 4.2.2 基础数据模块

此模块包含商品分类模块、商品模块、客户模块、账户模块、用户模块。除了商品模块使用单独的接口和界面，其余四种都继承一个共性的DataBLService接口。  
商品分类模块将使用CategoryBLService返回一个树形图模型用于界面的显示，并使用该服务完成增删查改的操作，不再赘述。  
其余四种模块使用通用的DataPanel面板，初始化时使用常量告知是何种数据类型的面板，并据此调用相应的Service获取表格模型。  
当点击增加按钮时候会跳转至新的窗口（同时原窗口锁死），新窗口将根据数据类型显示相应的输入面板，完成输入任务确认后返回主窗体。同理，修改按钮和其类似，只不过初始化时会将原数据传入窗体，业务逻辑也很相似。其余操作均不存在界面跳转。  

#### 4.2.3 单据制定模块

#### 4.2.4 统计分析模块

#### 4.2.5 通用组件模块

通用组件包含界面构造中可以复用的组件：
* 顶部按钮栏：通过addButton方法加入按钮（文字和图片），并绑定事件监听器。  
* 面板切换监听器：将实现PanelInterface的面板传入，用于主窗体切换面板。  
* 表格模型：继承DefaultTableModel实现可以更改表格各行各列允许编辑的范围。   

## 5 依赖视角

图5-1和5-2是客户端和服务器端各自的包之间的依赖关系
<center>![Alt text](./packagePic3.png)</center>
<center>图5-1</center>
<center>![Alt text](./packagePic4.png)</center>
<center>图5-2</center>

